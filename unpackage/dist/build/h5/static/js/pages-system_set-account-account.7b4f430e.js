(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-system_set-account-account"],{"3c47":function(e,t,a){"use strict";a("7a82");var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("2909"));a("a9e3"),a("d3b7"),a("159b"),a("caad"),a("2532");var l=n(a("f554")),r={props:{navHeight:{type:Number,default:0},bottom:{type:Number,default:15},right:{type:Number,default:15},top:{type:Number,default:0}},data:function(){return{height:0,tblHeight:0,body:null,containers:[],tableObj:null,tableButtonHeight:0,tablePaginationHeight:0}},mounted:function(){var e=this;this.body=document.getElementsByTagName("uni-page-body")[0],this.__height=this.body.clientHeight,this.containers=this.$refs.useTable.parentElement.querySelectorAll(".container"),this.tableStyle(),this.tableChange(),window.onresize=function(){e.tableChange()}},methods:{tableStyle:function(){var e=this;this.tableObj&&this.tableObj.ele||(this.containers.forEach((function(t){(0,i.default)(t.classList).includes("use-table")?e.tableObj={offset:e.$api.offset(t),ele:t}:e.__height-=t.clientHeight-15})),this.tableObj.ele.style.position="fixed",this.tableObj.ele.style.top=this.tableObj.offset.t+"px",this.tableObj.ele.style.left=this.tableObj.offset.l+"px",this.tableObj.ele.style.bottom=this.bottom+"px",this.tableObj.ele.style.right=this.right+"px",this.tableObj.ele.childNodes.length&&this.tableObj.ele.childNodes.forEach((function(t){(0,i.default)(t.classList).includes("el-pagination")?e.tablePaginationHeight=35:(0,i.default)(t.classList).includes("el-table")||(e.tableButtonHeight=55)})))},tableChange:function(){this.tblHeight=this.tableObj.ele.clientHeight-40-this.tableButtonHeight-this.tablePaginationHeight,this.tableObj.ele.querySelector(".el-table").style.height=this.tblHeight+"px"}},created:function(){var e=this;l.default.$on("fold",(function(t){e.tableObj.ele.style.left=t?e.tableObj.offset.l-116+"px":e.tableObj.offset.l+"px"}))}};t.default=r},"3e60":function(e,t,a){"use strict";a.r(t);var n=a("8bf9"),i=a.n(n);for(var l in n)["default"].indexOf(l)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(l);t["default"]=i.a},"4c35":function(e,t,a){"use strict";a.r(t);var n=a("ba4c"),i=a("bc45");for(var l in i)["default"].indexOf(l)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(l);var r=a("f0c5"),s=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"577ef3ec",null,!1,n["a"],void 0);t["default"]=s.exports},"8bf9":function(e,t,a){"use strict";a("7a82");var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("4d63"),a("c607"),a("ac1f"),a("2c3e"),a("25f0"),a("d3b7"),a("159b"),a("d81d");var i=n(a("c7eb")),l=n(a("1da1")),r="uni-id-users",s={data:function(){return{advancedSearch:!1,genderOptions:[{value:"",label:"全部"},{value:"0",label:"未知"},{value:"1",label:"男"},{value:"2",label:"女"}],req:{page:1,rows:10,orderby:"sort asc",username:"",gender:""},tblHeight:0,tableDatas:[],tableTotal:0,selectDatas:[]}},methods:{loadData:function(){var e=this;return(0,l.default)((0,i.default)().mark((function t(){return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$db[r].where({role:e.$db.$cmd.neq("member")}).whereif(e.req.username,{username:new RegExp(e.req.username)}).whereif(e.req.gender,{gender:e.req.gender}).field("avatar, username, role, mobile, gender, register_ip, register_date, comment").totable(e.req).then((function(t){200==t.code&&(t.datas.rows.forEach((function(e,t){switch(e.imgs=[e.avatar],e.register_date=new Date(e.register_date).format(),e.gender){case"1":e.gender="男";break;case"2":e.gender="女";break;default:e.gender="未知";break}})),e.tableDatas=t.datas.rows,e.tableTotal=t.datas.total)}));case 2:case"end":return t.stop()}}),t)})))()},toAdd:function(){var e=this;uni.navigateTo({url:"/pages/system_set/account/account_add_edit?tab=添加账号",events:{refreshData:function(){e.loadData()}}})},toEdit:function(e){var t=this;uni.navigateTo({url:"/pages/system_set/account/account_add_edit?id=".concat(e,"&tab=编辑账号"),events:{refreshData:function(){t.loadData()}}})},remove:function(e){var t=this;this.$confirm("此操作将永久删除该数据！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$db[r].remove(e).then((function(e){200==e.code&&t.loadData()}))}))},selectionChange:function(e){this.selectDatas=e},removes:function(){var e=this;if(this.selectDatas.length<=0)this.$message("请勾选需要删除的数据");else{var t=this.selectDatas.map((function(e){return e._id}));this.$confirm("此操作将永久删除勾选数据！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$db[r].where({_id:e.$db.$cmd.in(t)}).remove().then((function(t){200==t.code&&e.loadData()}))}))}},sizeChange:function(e){this.req.rows=e,this.loadData()},currentChange:function(e){this.req.page=e,this.loadData()}},created:function(){this.loadData()},updated:function(){this.tblHeight||(this.tblHeight=this.$refs.tbl.tblHeight)}};t.default=s},ba4c:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){}));var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{ref:"useTable"})},i=[]},bc45:function(e,t,a){"use strict";a.r(t);var n=a("3c47"),i=a.n(n);for(var l in n)["default"].indexOf(l)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(l);t["default"]=i.a},ca54:function(e,t,a){"use strict";a.r(t);var n=a("e2f4"),i=a("3e60");for(var l in i)["default"].indexOf(l)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(l);var r=a("f0c5"),s=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"28729624",null,!1,n["a"],void 0);t["default"]=s.exports},e2f4:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return n}));var n={useTable:a("4c35").default},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("use-table",{ref:"tbl"}),a("div",{staticClass:"container padding_b_0"},[a("div",{staticClass:"dflex_wrap"},[a("div",{staticClass:"dflex_vertical_c margin_r_40 margin_b_20"},[a("div",{staticClass:"search_name"},[e._v("用户名称：")]),a("el-input",{staticClass:"search_input",attrs:{placeholder:"请输入"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.loadData.apply(void 0,arguments)}},model:{value:e.req.username,callback:function(t){e.$set(e.req,"username",t)},expression:"req.username"}})],1),e.advancedSearch?a("div",{staticClass:"dflex_vertical_c margin_r_40 margin_b_20"},[a("div",{staticClass:"search_name"},[e._v("性别：")]),a("el-select",{staticClass:"search_input",on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.loadData.apply(void 0,arguments)}},model:{value:e.req.gender,callback:function(t){e.$set(e.req,"gender",t)},expression:"req.gender"}},e._l(e.genderOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),a("el-button",{staticClass:"search_btn margin_b_20 margin_r_40",attrs:{size:"mini"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.loadData.apply(void 0,arguments)}}},[e._v("搜索")]),e.advancedSearch?e._e():a("div",{staticClass:"search_advanced margin_b_20",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.advancedSearch=!e.advancedSearch}}},[e._v("高级筛选")]),e.advancedSearch?a("div",{staticClass:"search_common margin_b_20",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.advancedSearch=!e.advancedSearch}}},[e._v("常用筛选")]):e._e()],1)]),a("div",{staticClass:"container use-table"},[a("div",{staticClass:"dflex_sb margin_b_15"},[a("div",[a("el-button",{staticClass:"batch_btn padding0",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.removes.apply(void 0,arguments)}}},[e._v("删除")])],1),a("el-button",{staticClass:"add_btn pos_r padding0",attrs:{icon:"iconfont iconxinzeng"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toAdd.apply(void 0,arguments)}}},[e._v("新增")])],1),a("el-table",{attrs:{height:e.tblHeight,data:e.tableDatas,"highlight-current-row":!0},on:{"selection-change":function(t){arguments[0]=t=e.$handleEvent(t),e.selectionChange.apply(void 0,arguments)}}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{label:"用户",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"dflex_vertical_c"},[a("el-image",{staticStyle:{width:"40px",height:"40px","border-radius":"50%"},attrs:{src:t.row.avatar||"/static/img/default.jpg","preview-src-list":t.row.imgs,fit:"cover"}}),a("div",{staticClass:"margin_l_5"},[e._v(e._s(t.row.username))])],1)]}}])}),a("el-table-column",{attrs:{property:"user_role_names",label:"角色",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.role,(function(t,n){return a("el-tag",{key:n,staticClass:"margin_t_5 margin_r_5",attrs:{type:"info",size:"medium"}},[e._v(e._s(t))])}))}}])}),a("el-table-column",{attrs:{property:"mobile",label:"手机号",align:"center"}}),a("el-table-column",{attrs:{property:"gender",label:"性别",align:"center"}}),a("el-table-column",{attrs:{property:"register_ip",label:"IP",align:"center",width:"200"}}),a("el-table-column",{attrs:{property:"register_date",label:"创建时间",align:"center",width:"200"}}),a("el-table-column",{attrs:{property:"comment",label:"备注",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{content:"编辑",placement:"top","hide-after":1e3,enterable:!1,effect:"light"}},[a("el-button",{staticClass:"bbb",attrs:{type:"text",icon:"iconfont iconbianji"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.toEdit(t.row._id)}}})],1),a("el-tooltip",{attrs:{content:"删除",placement:"top","hide-after":1e3,enterable:!1,effect:"light"}},[a("el-button",{staticClass:"bbb",attrs:{type:"text",icon:"iconfont iconshanchu"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.remove(t.row._id)}}})],1)]}}])})],1),a("el-pagination",{attrs:{"current-page":e.req.page,"page-sizes":[10,20,30,50,100],"page-size":e.req.rows,layout:"total, sizes, prev, pager, next, jumper",total:e.tableTotal},on:{"size-change":function(t){arguments[0]=t=e.$handleEvent(t),e.sizeChange.apply(void 0,arguments)},"current-change":function(t){arguments[0]=t=e.$handleEvent(t),e.currentChange.apply(void 0,arguments)}}})],1)],1)},l=[]}}]);