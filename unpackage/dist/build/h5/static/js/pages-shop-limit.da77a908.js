(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-shop-limit"],{3251:function(t,e,a){"use strict";a.r(e);var n=a("ee42"),i=a("c96e");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);var l=a("f0c5"),o=Object(l["a"])(i["default"],n["b"],n["c"],!1,null,"4eb40d89",null,!1,n["a"],void 0);e["default"]=o.exports},c96e:function(t,e,a){"use strict";a.r(e);var n=a("fe31"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},ee42:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return n}));var n={useTable:a("4c35").default},i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("use-table",{ref:"tbl"}),a("div",{staticClass:"container_status dflex_vertical_c"},t._l(t.stateDatas,(function(e,n){return a("div",{key:n,staticClass:"item_interval"},[a("el-button",{staticClass:"badge_txt",class:{active:e.name==t.state},attrs:{size:"small"},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.cutSta(e)}}},[t._v(t._s(e.name))]),a("v-countup",{staticClass:"badge",attrs:{"start-value":"0","end-value":e.cnt}})],1)})),0),a("div",{staticClass:"container padding_b_0"},[a("div",{staticClass:"dflex_wrap"},[a("div",{staticClass:"dflex_vertical_c margin_r_40 margin_b_20"},[a("div",{staticClass:"search_name"},[t._v("商品名称：")]),a("el-input",{staticClass:"search_input",attrs:{placeholder:"请输入"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.loadData.apply(void 0,arguments)}},model:{value:t.req.name,callback:function(e){t.$set(t.req,"name",e)},expression:"req.name"}})],1),a("el-button",{staticClass:"search_btn margin_b_20 margin_r_40",attrs:{size:"mini"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.loadData.apply(void 0,arguments)}}},[t._v("搜索")])],1)]),a("div",{staticClass:"container use-table"},[a("div",{staticClass:"dflex_sb margin_b_15"},[a("div"),a("el-button",{staticClass:"add_btn pos_r padding0",attrs:{icon:"iconfont iconxinzeng"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toAdd.apply(void 0,arguments)}}},[t._v("新增")])],1),a("el-table",{attrs:{height:t.tblHeight,data:t.tableDatas,"highlight-current-row":!0}},[a("el-table-column",{attrs:{label:"排序",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{size:"small",min:1},on:{change:function(a){arguments[0]=a=t.$handleEvent(a),t.sortChange(e.row)},blur:function(a){arguments[0]=a=t.$handleEvent(a),t.sortChange(e.row)}},model:{value:e.row.sort,callback:function(a){t.$set(e.row,"sort",a)},expression:"scope.row.sort"}})]}}])}),a("el-table-column",{attrs:{label:"商品",width:"330",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"dflex_vertical_c"},[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.row.img,"preview-src-list":e.row.imgs,fit:"contain"}}),a("div",{staticClass:"left_just margin_l_10"},[a("div",{staticClass:"ellipsis"},[t._v(t._s(e.row.name))]),a("div",{staticClass:"ellipsis"},[t._v(t._s(e.row.name_pw))])])],1)]}}])}),a("el-table-column",{attrs:{label:"价格",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"price"},[t._v(t._s(e.row.price/100))]),a("div",{staticClass:"m_price"},[t._v(t._s(e.row.market_price/100))])]}}])}),a("el-table-column",{attrs:{property:"state",label:"状态",align:"center"}}),a("el-table-column",{attrs:{label:"数据统计",align:"left",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"left_just"},[a("div",[t._v("已售数:"+t._s(e.row.sale_cnt))]),a("div",[t._v("访问数:"+t._s(e.row.visit_cnt))]),a("div",[t._v("收藏数:"+t._s(e.row.collect_cnt))]),a("div",[t._v("分享数:"+t._s(e.row.share_cnt))])])]}}])}),a("el-table-column",{attrs:{label:"限时精选",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{attrs:{content:"1"==e.row.limited?"点击取消限时精选":"点击启用限时精选",placement:"top","hide-after":1e3,enterable:!1,effect:"light"}},[a("el-switch",{attrs:{"active-color":"#ff6a6c","inactive-color":"#bbb","active-value":"1","inactive-value":"0"},on:{change:function(a){arguments[0]=a=t.$handleEvent(a),t.limitedChange(e.row)}},model:{value:e.row.limited,callback:function(a){t.$set(e.row,"limited",a)},expression:"scope.row.limited"}})],1)]}}])}),a("el-table-column",{attrs:{label:"标签",width:"220",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"left_just"},t._l(e.row.tags,(function(e,n){return a("el-tag",{key:n,staticClass:"margin_t_5 margin_r_5",attrs:{effect:"plain",type:"info"}},[t._v(t._s(e))])})),1)]}}])})],1),a("el-pagination",{attrs:{"current-page":t.req.page,"page-sizes":[10,20,30,50,100],"page-size":t.req.rows,layout:"total, sizes, prev, pager, next, jumper",total:t.tableTotal},on:{"size-change":function(e){arguments[0]=e=t.$handleEvent(e),t.sizeChange.apply(void 0,arguments)},"current-change":function(e){arguments[0]=e=t.$handleEvent(e),t.currentChange.apply(void 0,arguments)}}}),a("popupsGoods",{ref:"child",on:{choiceGoods:function(e){arguments[0]=e=t.$handleEvent(e),t.choiceGoods.apply(void 0,arguments)}}})],1)],1)},s=[]},fe31:function(t,e,a){"use strict";a("7a82");var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("14d9"),a("4d63"),a("c607"),a("ac1f"),a("2c3e"),a("25f0"),a("d3b7"),a("159b"),a("d81d"),a("e9c4"),a("e25e"),a("4e82");var i=n(a("c7eb")),s=n(a("1da1")),l=n(a("0ebe")),o=n(a("ec57")),r="usemall-goods",c={components:{vCountup:l.default,popupsGoods:o.default},data:function(){return{state:"全部",stateObj:{"待审核":0,"销售中":0,"已下架":0,"全部":0},stateDatas:[],req:{limited:1,page:1,rows:10,orderby:"sort asc",name:"",state:""},tblHeight:0,tableDatas:[],tableTotal:0}},methods:{loadData:function(){var t=this;return(0,s.default)((0,i.default)().mark((function e(){var a;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a in t.stateDatas=[],t.stateObj)t.stateDatas.push({name:a,cnt:t.stateObj[a]});return e.next=4,t.$db[r].where({limited:1}).whereif(t.req.state&&"全部"!=t.req.state,{state:t.req.state}).whereif(t.req.name,{name:new RegExp(t.req.name)}).withgroup({field:"state",obj:t.stateObj}).totable(t.req).then((function(e){200==e.code&&(e.datas.group&&e.datas.group.datas&&(t.stateDatas=e.datas.group.datas),e.datas.rows.forEach((function(t){t.imgs=[t.img],t.limited=t.limited+""})),t.tableDatas=e.datas.rows,t.tableTotal=e.datas.total)}));case 4:case"end":return e.stop()}}),e)})))()},toAdd:function(){this.$refs.child.show({limited:0})},choiceGoods:function(t){var e=this,a=t.map((function(t){return t._id}));a&&a.length>0&&this.$db[r].where("in(_id, ".concat(JSON.stringify(a),")")).update("",{limited:1}).then((function(t){200==t.code&&e.loadData()}))},limitedChange:function(t){var e=this;this.$db[r].update(t._id,{limited:parseInt(t.limited)}).then((function(t){200==t.code&&e.loadData()}))},sortChange:function(t){var e=this;""!=t.sort&&this.$db[r].update(t._id,{sort:t.sort}).then((function(t){200==t.code&&e.loadData()}))},cutSta:function(t){this.state=t.name,this.req.state=t.name,this.loadData()},sizeChange:function(t){this.req.rows=t,this.loadData()},currentChange:function(t){this.req.page=t,this.loadData()}},created:function(){this.loadData()},updated:function(){this.tblHeight||(this.tblHeight=this.$refs.tbl.tblHeight)}};e.default=c}}]);