(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-shop-classify-classify_navigation_add_edit"],{"044f":function(e,t,a){var i=a("fad3");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("4f06").default;n("662f36d2",i,!0,{sourceMap:!1,shadowMode:!1})},"077b":function(e,t,a){"use strict";a("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("a9e3"),a("14d9"),a("d81d"),a("99af");var i={name:"tree-select",props:{data:{type:Array,default:function(){return[]}},defaultProps:{type:Object,default:function(){return{}}},multiple:{type:Boolean,default:function(){return!1}},clearable:{type:Boolean,default:function(){return!1}},collapseTags:{type:Boolean,default:function(){return!1}},nodeKey:{type:String,default:function(){return"id"}},checkStrictly:{type:Boolean,default:function(){return!1}},checkedKeys:{type:Array,default:function(){return[]}},size:{type:String,default:function(){return""}},width:{type:Number,default:function(){return 250}},height:{type:Number,default:function(){return 300}}},data:function(){return{isShowSelect:!1,options:[],selectedData:[],style:"width:"+this.width+"px;height:"+this.height+"px;",selectStyle:"width:"+(this.width+24)+"px;",checkedIds:[],checkedData:[]}},mounted:function(){this.initCheckedData()},methods:{setSelectOption:function(e){var t={};t.value=e.key,t.label=e.label,this.options=[],this.options.push(t),this.selectedData=e.key},checkSelectedNode:function(e){var t=e[0];this.$refs.tree.setCurrentKey(t);var a=this.$refs.tree.getNode(t);this.setSelectOption(a)},checkSelectedNodes:function(e){this.$refs.tree.setCheckedKeys(e)},clearSelectedNode:function(){this.selectedData="",this.$refs.tree.setCurrentKey(null)},clearSelectedNodes:function(){for(var e=this.$refs.tree.getCheckedKeys(),t=0;t<e.length;t++)this.$refs.tree.setChecked(e[t],!1)},initCheckedData:function(){this.multiple?this.checkedKeys.length>0?this.checkSelectedNodes(this.checkedKeys):this.clearSelectedNodes():this.checkedKeys.length>0?this.checkSelectedNode(this.checkedKeys):this.clearSelectedNode()},popoverHide:function(){this.multiple?(this.checkedIds=this.$refs.tree.getCheckedKeys(),this.checkedData=this.$refs.tree.getCheckedNodes()):(this.checkedIds=this.$refs.tree.getCurrentKey(),this.checkedData=this.$refs.tree.getCurrentNode()),this.$emit("popoverHide",this.checkedIds,this.checkedData)},handleNodeClick:function(e,t){this.multiple||(this.setSelectOption(t),this.isShowSelect=!this.isShowSelect,this.$emit("change",this.selectedData))},handleCheckChange:function(){var e=this,t=this.$refs.tree.getCheckedKeys();this.options=t.map((function(t){var a=e.$refs.tree.getNode(t),i={};return i.value=a.key,i.label=a.label,i})),this.selectedData=this.options.map((function(e){return e.value})),this.$emit("change",this.selectedData)},removeSelectedNodes:function(e){var t=this;this.$refs.tree.setChecked(e,!1);var a=this.$refs.tree.getNode(e);!this.checkStrictly&&a.childNodes.length>0&&(this.treeToList(a).map((function(e){e.childNodes.length<=0&&t.$refs.tree.setChecked(e,!1)})),this.handleCheckChange()),this.$emit("change",this.selectedData)},treeToList:function(e){var t=[],a=[];t=t.concat(e);while(t.length){var i=t.shift();i.childNodes&&(t=t.concat(i.childNodes)),a.push(i)}return a},removeSelectedNode:function(){this.clearSelectedNode(),this.$emit("change",this.selectedData)},changeSelectedNodes:function(e){this.multiple&&e.length<=0&&this.clearSelectedNodes(),this.$emit("change",this.selectedData)}},watch:{isShowSelect:function(){this.$refs.select.blur()}}};t.default=i},"11eb":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return i}));var i={uniFilePicker:a("8ba3").default},n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container add_edit"},[a("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"商品分类"}},[a("tree-select",{ref:"tree",staticClass:"sele",attrs:{data:e.goodsOptions,defaultProps:e.defaultProps,checkedKeys:e.defaultCheckedKeys,nodeKey:"_id"},on:{popoverHide:function(t){arguments[0]=t=e.$handleEvent(t),e.popoverHide.apply(void 0,arguments)}}})],1),a("el-form-item",{ref:"name",attrs:{label:"导航名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"轮播图片"}},[a("uni-file-picker",{attrs:{fileMediatype:"image",returnType:"object","image-styles":e.imageStyle},on:{success:function(t){arguments[0]=t=e.$handleEvent(t),e.imgUpload.apply(void 0,arguments)},delete:function(t){arguments[0]=t=e.$handleEvent(t),e.imgDelete.apply(void 0,arguments)}},model:{value:e.imageValue,callback:function(t){e.imageValue=t},expression:"imageValue"}})],1),a("el-form-item",{attrs:{label:"跳转类型"}},[a("el-radio-group",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-radio",{attrs:{label:"页面"}},[e._v("页面")]),a("el-radio",{attrs:{label:"网页"}},[e._v("网页")])],1)],1),a("el-form-item",{attrs:{label:"地址"}},[a("el-select",{staticClass:"sele",attrs:{placeholder:"请选择",disabled:"网页"==e.form.type},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.urlChange.apply(void 0,arguments)}},model:{value:e.mpPageUrl,callback:function(t){e.mpPageUrl=t},expression:"mpPageUrl"}},e._l(e.urlOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name+" "+e.url,value:e._id}})})),1)],1),a("el-form-item",{ref:"url",attrs:{label:"跳转地址",prop:"url"}},[a("el-input",{attrs:{placeholder:"自动获取上面选中的值"},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}}),a("div",{staticClass:"remark_txt"},[e._v(e._s(e.remark))])],1),a("el-form-item",{attrs:{label:"排序"}},[a("el-input",{attrs:{type:"number",min:"0",placeholder:"请输入排序"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",e._n(t))},expression:"form.sort"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-switch",{attrs:{"active-color":"#ff6a6c","inactive-color":"#bbb","active-value":"启用","inactive-value":"禁用"},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}})],1),a("el-form-item",[a("el-button",{staticClass:"confirm_btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submitForm("ruleForm")}}},[e._v("确 定")]),a("el-button",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.returnPage.apply(void 0,arguments)}}},[e._v("返回列表")])],1)],1)],1)},r=[]},"45a4":function(e,t,a){"use strict";a("7a82");var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("d3b7"),a("159b"),a("14d9"),a("7db0");var n=i(a("c7eb")),r=i(a("1da1")),l=i(a("f554")),o=i(a("f457")),s="usemall-app-category",c={components:{TreeSelect:o.default},data:function(){return{dataId:"",form:{cid:"",name:"",img:"",type:"页面",url:"",sort:0,remark:"",state:"启用"},imageValue:null,imageStyle:{height:"150px",width:"150px"},goodsOptions:[],defaultProps:{children:"children",label:"name"},defaultCheckedKeys:[],urlOptions:[],remark:"",mpPageUrl:"",rules:{name:[{required:!0,message:"请输入导航名称",trigger:"change"}],url:[{required:!0,message:"请输入地址",trigger:"change"}]}}},methods:{loadData:function(){var e=this;return(0,r.default)((0,n.default)().mark((function t(){return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$db["usemall-goods-category"].totree({orderby:"sort asc",startWith:'pid == ""'}).then((function(t){200==t.code&&(e.goodsOptions=t.datas)}));case 2:return t.next=4,e.$db["usemall-app-wxmini-page"].tolist().then((function(t){200==t.code&&t.datas.forEach((function(t){e.urlOptions.push(t)}))}));case 4:if(e.dataId){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,e.$db[s].tofirst(e.dataId).then((function(t){if(200==t.code){for(var a in e.form)e.form[a]=t.datas[a];e.form.img&&(e.imageValue={},e.imageValue.url=e.form.img)}}));case 8:case"end":return t.stop()}}),t)})))()},submitForm:function(e){var t=this;this.form.cid=this.form.cid||"",this.$refs[e].validate((function(e,a){t.$api.set_unvalidated_form_focus(t,a),e&&(t.dataId?t.$db[s].update(t.dataId,t.form).then((function(e){200==e.code&&(t.getOpenerEventChannel().emit("loadData"),t.returnPage())})):t.$db[s].add(t.form).then((function(e){200==e.code&&(t.getOpenerEventChannel().emit("loadData"),t.returnPage())})))}))},imgUpload:function(e){this.form.img=e.tempFilePaths[0]},imgDelete:function(){this.imageValue=null,this.form.img=""},popoverHide:function(e,t){this.form.cid=e,this.form.name=t.name,this.form.img=t.img,this.imageValue={},this.imageValue.url=t.img},returnPage:function(){l.default.$emit("tab-close"),this.$router.push("/pages/shop/classify/classify_navigation")},urlChange:function(e){var t=this.urlOptions.find((function(t){return t._id==e}));this.form.url=t.url,this.remark=t.remark}},created:function(){this.dataId=this.$route.query.id||"",this.loadData()}};t.default=c},"5b40":function(e,t,a){var i=a("f9b0");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("4f06").default;n("255d325e",i,!0,{sourceMap:!1,shadowMode:!1})},6198:function(e,t,a){"use strict";a.r(t);var i=a("077b"),n=a.n(i);for(var r in i)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(r);t["default"]=n.a},"772b":function(e,t,a){"use strict";a.r(t);var i=a("11eb"),n=a("ba52");for(var r in n)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(r);a("b8ed");var l=a("f0c5"),o=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"789bb5d6",null,!1,i["a"],void 0);t["default"]=o.exports},"7b49":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowSelect,expression:"isShowSelect"}],staticClass:"mask",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.isShowSelect=!e.isShowSelect}}}),a("el-popover",{attrs:{placement:"bottom-start",width:e.width,trigger:"manual"},on:{hide:function(t){arguments[0]=t=e.$handleEvent(t),e.popoverHide.apply(void 0,arguments)}},model:{value:e.isShowSelect,callback:function(t){e.isShowSelect=t},expression:"isShowSelect"}},[a("el-tree",{ref:"tree",staticClass:"common-tree",style:e.style,attrs:{data:e.data,props:e.defaultProps,"show-checkbox":e.multiple,"node-key":e.nodeKey,"check-strictly":e.checkStrictly,"default-expand-all":!0,"expand-on-click-node":!1,"check-on-click-node":e.multiple,"highlight-current":!0},on:{"node-click":function(t){arguments[0]=t=e.$handleEvent(t),e.handleNodeClick.apply(void 0,arguments)},"check-change":function(t){arguments[0]=t=e.$handleEvent(t),e.handleCheckChange.apply(void 0,arguments)}}}),a("el-select",{ref:"select",staticClass:"tree-select",style:e.selectStyle,attrs:{slot:"reference",size:e.size,multiple:e.multiple,clearable:e.clearable,"collapse-tags":e.collapseTags},on:{"remove-tag":function(t){arguments[0]=t=e.$handleEvent(t),e.removeSelectedNodes.apply(void 0,arguments)},clear:function(t){arguments[0]=t=e.$handleEvent(t),e.removeSelectedNode.apply(void 0,arguments)},change:function(t){arguments[0]=t=e.$handleEvent(t),e.changeSelectedNodes.apply(void 0,arguments)}},nativeOn:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.isShowSelect=!e.isShowSelect}},slot:"reference",model:{value:e.selectedData,callback:function(t){e.selectedData=t},expression:"selectedData"}},e._l(e.options,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1)],1)},n=[]},b8ed:function(e,t,a){"use strict";var i=a("044f"),n=a.n(i);n.a},ba52:function(e,t,a){"use strict";a.r(t);var i=a("45a4"),n=a.n(i);for(var r in i)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(r);t["default"]=n.a},dc61:function(e,t,a){"use strict";var i=a("5b40"),n=a.n(i);n.a},f457:function(e,t,a){"use strict";a.r(t);var i=a("7b49"),n=a("6198");for(var r in n)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(r);a("dc61");var l=a("f0c5"),o=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"760e2719",null,!1,i["a"],void 0);t["default"]=o.exports},f9b0:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,".mask[data-v-760e2719]{width:100%;height:100%;position:fixed;top:0;left:0;opacity:0;z-index:11}.common-tree[data-v-760e2719]{overflow:auto}.tree-select[data-v-760e2719]{z-index:111}",""]),e.exports=t},fad3:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,".el-tree.common-tree.el-tree--highlight-current[data-v-789bb5d6]{width:auto!important}",""]),e.exports=t}}]);